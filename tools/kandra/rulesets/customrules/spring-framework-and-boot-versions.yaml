- ruleID: spring-framework-version-detection-00001
  category: optional
  effort: 1
  labels:
    - konveyor.io/source=spring
    - konveyor.io/target=spring-version-check
  when:
    or:
      - builtin.xml:
          filepaths:
            - pom.xml
          namespaces:
            m: http://maven.apache.org/POM/4.0.0
          xpath: //m:spring-framework.version
      - builtin.file:
          filepaths:
            - build.gradle
            - build.gradle.kts
          contains:
            - springBootVersion
            - spring-framework.version
  description: Detects Spring Framework and Spring Boot versions
  message: |
    Detected Spring Framework or Spring Boot version. Please check the extracted version and ensure it's supported.
  links:
    - title: 'Spring Framework Support'
      url: https://spring.io/projects/spring-framework#support
    - title: 'Spring Boot Support'
      url: https://spring.io/projects/spring-boot#support

- ruleID: spring-framework-version-check-00002
  category: mandatory
  effort: 3
  labels:
    - konveyor.io/source=spring
    - konveyor.io/target=spring-version-update
  when:
    java.dependency:
      name: org.springframework
      version: "[2.0.0,5.1.9)"
  description: Detects unsupported Spring Framework versions
  message: |
    Detected unsupported Spring version. Please upgrade to a supported version immediately.
  links:
    - title: 'Spring Framework Support'
      url: https://spring.io/projects/spring-framework#support

- ruleID: spring-framework-version-check-00003
  category: potential
  effort: 2
  labels:
    - konveyor.io/source=spring
    - konveyor.io/target=spring-version-update
  when:
    java.dependency:
      nameregex: org\.springframework(\.boot)?.*
      versionregex: (2\.5\.|5\.2\.).*
  description: Detects Spring Framework or Spring Boot versions approaching end-of-life
  message: |
    Detected Spring version approaching end-of-life. Consider upgrading to a newer version soon.
  links:
    - title: 'Spring Framework Support'
      url: https://spring.io/projects/spring-framework#support
    - title: 'Spring Boot Support'
      url: https://spring.io/projects/spring-boot#support
