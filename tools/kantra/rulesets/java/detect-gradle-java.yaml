# detect-gradle-java.yaml

- ruleID: detect-gradle-java-8
  category: informational
  effort: 1
  labels:
    - konveyor.io/source=gradle
    - konveyor.io/source=build-tool
    - konveyor.io/language=java
    - konveyor.io/tech=java-8
  when:
    builtin.file:
      filepaths:
        - build.gradle
        - build.gradle.kts
      # Looks for sourceCompatibility or targetCompatibility with '1.8'
      pattern: "(?i)\\b(sourceCompatibility|targetCompatibility)\\s*=\\s*['\"]1\\.8['\"]"
  description: "Detects usage of Java 8 via Gradle build files."
  message: |
    This Gradle project is configured for Java 8.

- ruleID: detect-gradle-java-gt-1.8
  category: informational
  effort: 1
  labels:
    - konveyor.io/source=gradle
    - konveyor.io/source=build-tool
    - konveyor.io/language=java
    - konveyor.io/tech=java-gt-1.8
  when:
    builtin.file:
      filepaths:
        - build.gradle
        - build.gradle.kts
      # Simple pattern for '9', '10', '11', '12'... up to '29'; adjust as needed
      pattern: "(?i)\\b(sourceCompatibility|targetCompatibility)\\s*=\\s*['\"](9|1[0-9]|2[0-9])['\"]"
  description: "Detects usage of Java versions greater than 1.8 in Gradle build files."
  message: |
    This Gradle project is configured for Java version greater than 1.8.

- ruleID: detect-gradle-java-11
  category: informational
  effort: 1
  labels:
    - konveyor.io/source=gradle
    - konveyor.io/source=build-tool
    - konveyor.io/language=java
    - konveyor.io/tech=java-11
  when:
    builtin.file:
      filepaths:
        - build.gradle
        - build.gradle.kts
      pattern: "(?i)\\b(sourceCompatibility|targetCompatibility)\\s*=\\s*['\"]11['\"]"
  description: "Detects usage of Java 11 via Gradle build files."
  message: |
    This Gradle project is configured for Java 11.

- ruleID: detect-gradle-java-17
  category: informational
  effort: 1
  labels:
    - konveyor.io/source=gradle
    - konveyor.io/source=build-tool
    - konveyor.io/language=java
    - konveyor.io/tech=java-17
  when:
    builtin.file:
      filepaths:
        - build.gradle
        - build.gradle.kts
      pattern: "(?i)\\b(sourceCompatibility|targetCompatibility)\\s*=\\s*['\"]17['\"]"
  description: "Detects usage of Java 17 via Gradle build files."
  message: |
    This Gradle project is configured for Java 17.

- ruleID: detect-gradle-java-21
  category: informational
  effort: 1
  labels:
    - konveyor.io/source=gradle
    - konveyor.io/source=build-tool
    - konveyor.io/language=java
    - konveyor.io/tech=java-21
  when:
    builtin.file:
      filepaths:
        - build.gradle
        - build.gradle.kts
      pattern: "(?i)\\b(sourceCompatibility|targetCompatibility)\\s*=\\s*['\"]21['\"]"
  description: "Detects usage of Java 21 via Gradle build files."
  message: |
    This Gradle project is configured for Java 21.