- ruleID: "spring-boot-supported-version-gradle"
  category: "informational"
  effort: 1
  labels:
    - "cto.io/spring-boot-version=spring-boot-2.7+"
    - "cto.io/spring-boot-status=spring-boot-supported"
  when:
    or:
      - builtin.filecontent:
          filePattern: build.gradle
          pattern: implementation\s*\(['"]org\.springframework\.boot:spring-boot-starter.*:((2\.(7|[8-9]|\d{2,}))|([3-9]|[1-9]\d+)\.\d+(\.\d+)?)['"]\)

      - builtin.filecontent:
          filePattern: build.gradle.kts
          pattern: implementation\(["']org\.springframework\.boot:spring-boot-starter.*:((2\.(7|[8-9]|\d{2,}))|([3-9]|[1-9]\d+)\.\d+(\.\d+)?)["']\)

      - and:
          - builtin.filecontent:
              filePattern: build.gradle
              pattern: implementation\s*\(['"]org\.springframework\.boot:spring-boot-starter.*:\$springBootVersion['"]\)
          - builtin.filecontent:
              filePattern: gradle.properties
              pattern: springBootVersion\s*=\s*((2\.(7|[8-9]|\d{2,}))|([3-9]|[1-9]\d+)\.\d+(\.\d+)?)

      - and:
          - builtin.filecontent:
              filePattern: build.gradle.kts
              pattern: implementation\(["']org\.springframework\.boot:spring-boot-starter.*:\$\{springBootVersion\}["']\)
          - builtin.filecontent:
              filePattern: gradle.properties
              pattern: springBootVersion\s*=\s*((2\.(7|[8-9]|\d{2,}))|([3-9]|[1-9]\d+)\.\d+(\.\d+)?)

      - builtin.filecontent:
          filePattern: build.gradle
          pattern: id\s*\(['"]org\.springframework\.boot['"]\)\s*version\s*['"]((2\.(7|[8-9]|\d{2,}))|([3-9]|[1-9]\d+)\.\d+(\.\d+)?)['"]\)

      - builtin.filecontent:
          filePattern: build.gradle.kts
          pattern: id\(["']org\.springframework\.boot["']\)\s*version\s*["']((2\.(7|[8-9]|\d{2,}))|([3-9]|[1-9]\d+)\.\d+(\.\d+)?)["']\)

  description: "Detected supported Spring Boot version (>=2.7)."
  message: |
    Your Gradle project uses Spring Boot version 2.7.x or newer, which is generally considered supported.
    No immediate upgrade is required (unless you want to move to a newer major release).
  links:
    - title: "Spring Boot Release Notes"
      url: "https://github.com/spring-projects/spring-boot/wiki"
