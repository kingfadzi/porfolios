- ruleID: "spring-framework-supported-version"
  category: "informational"
  effort: 1
  labels:
    - "cto.io/source=spring-framework"
    - "cto.io/spring-framework-version=spring-framework-6.2+"
    - "cto.io/build-tool=maven"
    - "cto.io/spring-framework-status=spring-framework-supported"
  when:
    or:
      - builtin.xml:
          filepaths:
            - "effective-pom.xml"
          namespaces:
            m: "http://maven.apache.org/POM/4.0.0"
          xpath: >
            //m:project/m:dependencies/m:dependency[
              m:groupId='org.springframework'
              and (
                number(substring-before(m:version, '.')) > 6
                or (
                  number(substring-before(m:version, '.')) = 6
                  and number(substring-before(substring-after(m:version, '.'), '.')) >= 2
                )
              )
            ]

      - builtin.xml:
          filepaths:
            - "effective-pom.xml"
          namespaces:
            m: "http://maven.apache.org/POM/4.0.0"
          xpath: >
            //m:project/m:build/m:plugins/m:plugin[
              m:groupId='org.springframework'
              and (
                number(substring-before(m:version, '.')) > 6
                or (
                  number(substring-before(m:version, '.')) = 6
                  and number(substring-before(substring-after(m:version, '.'), '.')) >= 2
                )
              )
            ]
  description: "Detected supported Spring Framework version (> 6.2.x)."
  message: |
    Detected Spring Framework version 6.2.x or newer, which is currently supported.
  links:
    - title: "Spring Framework Release Notes"
      url: "https://github.com/spring-projects/spring-framework/wiki"
