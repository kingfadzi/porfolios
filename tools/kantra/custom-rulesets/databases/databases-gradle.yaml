- ruleID: "database-mongodb-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=MongoDB"
    - "cto.io/database-type=document"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: org\.mongodb:mongodb-driver-sync:.*
  message: "Detected usage of MongoDB database."
  description: "Detected usage of MongoDB database."

- ruleID: "database-elasticsearch-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=Elasticsearch"
    - "cto.io/database-type=search"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: org\.elasticsearch\.client:elasticsearch-rest-high-level-client:.*
  message: "Detected usage of Elasticsearch database."
  description: "Detected usage of Elasticsearch database."

- ruleID: "database-cassandra-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=Cassandra"
    - "cto.io/database-type=nosql"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: com\.datastax\.cassandra:cassandra-driver-core:.*
  message: "Detected usage of Cassandra database."
  description: "Detected usage of Cassandra database."

- ruleID: "database-couchbase-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=Couchbase"
    - "cto.io/database-type=nosql"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: com\.couchbase\.client:java-client:.*
  message: "Detected usage of Couchbase database."
  description: "Detected usage of Couchbase database."

- ruleID: "database-neo4j-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=Neo4j"
    - "cto.io/database-type=graph"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: org\.neo4j\.driver:neo4j-java-driver:.*
  message: "Detected usage of Neo4j database."
  description: "Detected usage of Neo4j database."

- ruleID: "database-dynamodb-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=DynamoDB"
    - "cto.io/database-type=nosql"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: com\.amazonaws:aws-java-sdk-dynamodb:.*
  message: "Detected usage of DynamoDB database."
  description: "Detected usage of DynamoDB database."

- ruleID: "database-hbase-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=HBase"
    - "cto.io/database-type=columnar"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: org\.apache\.hbase:hbase-client:.*
  message: "Detected usage of HBase database."
  description: "Detected usage of HBase database."

- ruleID: "database-oracle-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=Oracle"
    - "cto.io/database-type=relational"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: com\.oracle\.database\.jdbc:ojdbc8:.*
  message: "Detected usage of Oracle database."
  description: "Detected usage of Oracle database."

- ruleID: "database-sqlserver-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=SQLServer"
    - "cto.io/database-type=relational"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: com\.microsoft\.sqlserver:mssql-jdbc:.*
  message: "Detected usage of SQL Server database."
  description: "Detected usage of SQL Server database."

- ruleID: "database-postgresql-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=PostgreSQL"
    - "cto.io/database-type=relational"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: org\.postgresql:postgresql:.*
  message: "Detected usage of PostgreSQL database."
  description: "Detected usage of PostgreSQL database."

- ruleID: "database-mysql-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=MySQL"
    - "cto.io/database-type=relational"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: mysql:mysql-connector-java:.*
  message: "Detected usage of MySQL database."
  description: "Detected usage of MySQL database."

- ruleID: "database-mariadb-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=MariaDB"
    - "cto.io/database-type=relational"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: org\.mariadb\.jdbc:mariadb-java-client:.*
  message: "Detected usage of MariaDB database."
  description: "Detected usage of MariaDB database."

- ruleID: "database-h2-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=H2"
    - "cto.io/database-type=relational"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: com\.h2database:h2:.*
  message: "Detected usage of H2 database."
  description: "Detected usage of H2 database."

- ruleID: "database-db2-gradle"
  category: "mandatory"
  effort: 1
  labels:
    - "cto.io/database=Db2"
    - "cto.io/database-type=relational"
  when:
    or:
      - builtin.filecontent:
          filePattern: all-deps-nodupes.txt
          pattern: com\.ibm\.db2:jcc:.*
  message: "Detected usage of IBM Db2 database."
  description: "Detected usage of IBM Db2 database."
